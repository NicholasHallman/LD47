pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
#include ./src/husk.lua

#include ./src/world.lua

#include ./src/door.lua

#include ./src/textbox.lua

#include ./src/player.lua

#include ./src/menus.lua

door_man = door_manager()

world = make_world()

player = make_player()

textbox = make_textbox()

title = make_title()
help_screen = make_help()

screen = "title"

function _init()
  print(player.x)
  world:init()
  door_man:init()
end

function _draw()
  cls(0)
  if screen == 'title' then
    title:draw()
  elseif screen == 'help' then
    help_screen:draw()
  else
    world:draw(player)
    player:draw()
    textbox:draw()
  end
end

function _update()
  if screen == 'title' then 
    title:update()
    if title.start_game == true then
      screen = 'game'
    elseif title.show_help == true then
      screen = 'help'
    end
  elseif screen == 'help' then
    help_screen:update()
    if help_screen.back == true then
      screen = 'title'
      help_screen = make_help()
      title = make_title()
    end
  else
    if player.active then player:update() end
    world:update(player)
    door_man:update(player)
  end
end
__gfx__
01111110011111100111111000000777000007770000077700000777000000000000000000666660000000000066666006666600000000006066060006006060
00550500005505000055050000777770000777700007766000077660000000000000000006606606006666600660660666066060066666006600060000600606
00555500005555000055550007777700007777000776667007766670000000000000000000666660066066060066666006666600660660606600060060066666
00044000000440000504405077700000077770007666670076666700766660000000000000606060006666600060606006060600060006000066600006066666
00544500005445000054450000000000777000007666600076666700766660000000000000006000006060600606660600060000066666000006000000666666
05044050050440500004400000000000000000000766600007766670077666000666600000066600060666060006660000666000000600000066660000660660
00055000000550000550055000000000000000000777700000077660000776600006666006066606000666000066006060666060066660060066600600066666
00500500000550000000000000000000000000000000000000000777000007770000066600060600000606000000006000606000006060000060600000606000
01111110001111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666000000000
00550500000550500000000000000000000000000000000000000000000000000000000000666660000000000000000000000000000000000660660600666660
00555500000555500000000000000000000000000000000000000000000000000000000006606606006666600000000000666660000000006066666006606606
05044050005044050005000100000000000000000000000000000000000000000000000000666660066066060000000006606606006666600060606600666660
00544500000544500000055100000000000000000000000000000000000000000000000000606060006666600000000000666660066066060000600000606060
00044000000044000000055100000000000000000000000000000000000000000000000000066600006060600000000000606060006666600006660006066606
00055000000055000544450100000000000000000000000000000000000000000000000006066606060666060000000006066606066060660060006000066600
00500500000555005545455100000000000000000000000000000000000000000000000000060600006000600000000000600060006000600000000000060600
77777777777777777711111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777777777777711111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77111111111111117711111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77111111111111117711111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77111111111111117711111100000000000000000000000000000000000000000000000009900090000000000000000000000000000000000000000000000000
77111111111111117711111100000000000000000000000000000000000000000000000009909090000000000000000000000000000000000000000000000000
77111111111111117711111100000000000000000000000000000000000000000000000009999990000000000000000000000000000000000000000000000000
77111111111111117711111100000000000000000000000000000000000000000000000009900000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555555505550555055577777777777d777d777d777733333333300030003000303388888888808888000088880800000000000000000000000000000000
50005000500050005000500576667666766d766d766d766730303030330303030303030308000080880000800800008800000000033303000000000000888800
550555055505550555055505666d666d766d666d666d666700300030300030003000303380088008800880088008800800000000333333300000000008000080
005000505050005000500055dddddddd76dddddddddddd670030003033030303030303038080080880800808808008080000d0d0333303030000000080000008
055505555555055505550555777d777d777d777d777d77773000300030003000300030338080080880800808808008080d00ddd0033330330666666080999908
500050005000500050005005766d766d766d766d766d7667030303033303030303030303800880088008800880088008ddd0ddd03333333306666dd000899800
550555055505550555055505666d666d766d666d666d6667300030003000300030003033080000808800008008000088ddd0ddd03333333300666d0000898800
005000505050005000500055dddddddd76dddddddddddd670303030333030303030303030088880080888800008888080d00ddd03333333000666d0000889800
055505550555055500055000777d777d777d777d000000003000300030003000404040040088880000888800000000000d0ddddd40333340066666d000898800
500050005000500000044000766d766d766d766d000000000303030303030303040000400800008008000080000000000ddddddd04440400066666d000889800
550555055505550500044000666d666d666d666d000000003000300030003000060040608008800880088008000000000d00dddd00044000066666d000899800
005000500050005000044000dddddddddddddddd000000000303030303030303404000448080080880800808000000000d00ddd00044400066666ddd00898800
055505555555555500099000777d777d777d777d000000003000300030003000004040008080080880800808000000000d00ddd0040440006666d6dd00889800
500050005000500000044000766d766d766d766d000000000303030303000300400004048008800888088088000000000d00d0d004044400666d6ddd00899800
550555050000000000044000666d666d66606660000000003000300003030030040460000800008080800808000000000d00d0d0004444000666ddd000898800
005000500000000000055000dddddddd00000000000000000303030330003300044004040088880008000080000000000d0dd0dd4444444000dddd0008989980
555505550000000000000000777d7777000000000000000030003003000000000000000080888808000000000000000000000010333333330000005002222220
500050050000000000000000766d7667000000000000000033030303000000000000000088000088000000000000000000000010333303030050005002000020
550555050000000000000000766d6667000000000000000030003003000000000000000080088008000000000000000011111111333330335500000502022020
5050005500000000000000007dddddd7000000000000000033030303000000000000000080800808000000000000000001000000333333330050000002022020
555505550000000000000000777d7777000000000000000030003003000000000000000080800808000000000000000001000000303033330500000002022020
500050050000000000000000766d7667000000000000000033030303000000000000000080088008000000000000000001000000330333330500055002022020
550555050000000000000000766d6667000000000000000030003003000000000000000088000088000000000000000011111111333333330055500002022020
55555555000000000000000077777777000000000000000033333333000000000000000088888888000000000000000000000010333333330000000002022020
55555555555555555555555577777777777777777777777733333333333333333333333388888888888888888888888804000040005555000000000002022020
50000000000000000000000576666666666666666666666d033333333333333333333330800800800808808008008008040000400d5558000000000002200220
50000000000000000000000576666666666666666666666d003030333003033003030300080088000088880000880080044444400d2222000000000000200200
555555555555555555555555dddddddddddddddddddddddd000003300303000303003000008888888888888888888800040000400d2225000000000000222200
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000400ddddd000000000000022000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000400d222d200000000000022000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044444400ddddd200000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000400d000d500000000000000000
00000000000000000000000000000000000000000000000000000000040000000714858585858585858585858585050505050505050505050505050505052400
14050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000040000000015151515151515151515151515151515151515151515151515151515151500
14050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000041727000000000000000000000000000000000000000000000000000000000000000000
14050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000
14050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000040404040404040404040404040404040404040404040404040400000000000000000000
14050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000040404000000000000
14050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000250000000000000000000000000000000000000000000000
14050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000004040404040404040404040404040404040404040404040404040404040404040404040404
05050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000043434343434343434300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000434353535454545454535343430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000043535354540000000000545453534300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000004353545400000000000000000054544443000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000004445000000000000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000004445000000000000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000444500000000000000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000444500000000000000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000434343434343434343434343434343534500000000000000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000545454545454545454545454545454545454456c006c00000000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4d4d4d4d00000000000000006c6c6c6c6c6c6c6c6c6c6c6c6c6c6c6c6c6c45006c0000000000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6d6d6d6d4d000000000000006c6c6c6c6c6c6c6c6c6c6c6c6c6c6c6c6c6c546c006c006c0000000000000000004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6d6d6d6d4d000000000000006c4c006c4c006c4c006c6c6c6c6c6c6c6c6c6c6c4e006c006c0000000000004e004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5d5d5d5d00000000000000006c5c006c5c006c5c006c6c6c6c6c6c6c6c6c6c6c5e00006c006c6c000000005e004445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
464646464646464646464646434343434343434343434343434343434343434343434343436c6c4343434343435345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
585858585858585858585858545454545454545454545454545454545454545454545454456c6c4453535353535345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
585858585858585858585858585858585858585858585858585858585858585858585858586e6e5858585858585858000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
585858585858585858585858585858585858585858585858585858585858585858585858586e6e5858585800580000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000005800005800585858586e6e5858580058000058000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000005800585858006e5858005800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
505151515151515151515151515151515151515050000000000000000000580000580058586e005800580000580000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
42000000000000000000000000000000000000415000000000000000000000000000585858006e5858000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4200000000000000000000000000000000000041505050505050505050505050505058585800005800005800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
420000000000006f00006f00006f00006f000051515151515151515151515151515058585800000000000000000000004140404040404040404040404042000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
420000000000007f00007f00007f00007f000000000000000000000000000000004158585800000000000000000000004151515151515151515151515042000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4200000000000000000000000000000000000000000000000000000000000000004158585800000000000000000000004100000000000000000000004142000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
420000000000004c00004c00004c00004c000000000000000000000000000000004158585800000000000000000000004100000000000000000000004142000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
42007d000000005c00005c00005c00005c000000000000000000000000000000004158585800000000000000000000000000000000000000000000004150404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
504040404040404040404040404040404040404040404040404040404000000000415858580000000000000000004c000000000070717171720000006000000000410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000004071720000415858580000000000000000005c000000000000000000000000005200000000410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000040000000004158585858585858585858585840404040404040404040404040404040420041500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__sfx__
00010000016500265004650056500665007650096500a650351403514035140351403514035140351403514035130351203512035120351203512035120351203511035110351103511035110351103511035110
00010000090500605002050010500105003050060500a0500d0501305013050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
